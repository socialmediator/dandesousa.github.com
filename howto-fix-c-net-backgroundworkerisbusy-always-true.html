<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Dan De Sousa's Blog</title>
    <meta name="description" content="">
    <meta name="author" content="Dan De Sousa">

    <link href="./theme/css/bootstrap.min.css" rel="stylesheet">
    <link href="./theme/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="./theme/css/font-awesome.min.css" rel="stylesheet">
    <link href="./theme/css/timberland.css" rel="stylesheet">
    <link href="./theme/css/timberland-icons.css" rel="stylesheet">
    <link href="./theme/css/timberland-pygments.css" rel="stylesheet">
        <script>var _gaq=[['_setAccount','UA-10113677-1'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>
    <script type="text/javascript">
	var disqus_identifier = "howto-fix-c-net-backgroundworkerisbusy-always-true.html";
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = 'http://dandesousacom.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
  </head>
  <body>
            <div class="navbar">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="brand" href="./index.html">Dan De Sousa's Blog</a>
          <ul class="nav">
                                                <li ><a href="./pages/about.html">About</a></li>
                                  </ul>
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span2">
          <div class="social">
            <h2><small>Social</small></h2>
            <ul class="unstyled">
                                          <li><i class="icon-facebook-sign icon-large icon-color-facebook"></i> <a href="https://facebook.com/daniel.sousa">Facebook</a></li>
                                          <li><i class="icon-github-sign icon-large icon-color-github"></i> <a href="http://github.com/dandesousa">Github</a></li>
                                          <li><i class="icon-google-plus-sign icon-large icon-color-google-plus"></i> <a href="https://plus.google.com/114589102912613956952">Google Plus</a></li>
                                          <li><i class="icon-twitter-sign icon-large icon-color-twitter"></i> <a href="http://twitter.com/dandesousa">Twitter</a></li>
                          </ul>
          </div>
          <hr class="soften-left-right" />
          <h2><small>Categories</small></h2>
          <ul class="unstyled">
                        <li><span class="badge ">3</span> <a href="./category/articles.html">Articles</a></li>
                        <li><span class="badge ">1</span> <a href="./category/personal.html">Personal</a></li>
                        <li><span class="badge ">1</span> <a href="./category/politics.html">Politics</a></li>
                        <li><span class="badge ">14</span> <a href="./category/programming.html">Programming</a></li>
                        <li><span class="badge ">1</span> <a href="./category/ramblings.html">Ramblings</a></li>
                        <li><span class="badge badge-success">17</span> <a href="./category/technology.html">Technology</a></li>
                      </ul>
          <hr class="soften-left-right" />
                    <h2><small>History</small></h2>
          <ul class="unstyled">
            <li><i class="icon-book"></i> <a href="./archives.html">Archives</a></li>
            <li><i class="icon-tags"></i> <a href="./tags.html">Tags</a></li>
          </ul>
        </div>

        <div class="span10">
                    <div class='article'>
  <div class="page-header"><h1>Howto Fix: C# .Net Backgroundworker.Isbusy Always True</h1>
    <ul class="unstyled">
  <li><i class="icon-time"></i> <a class="more" href="./howto-fix-c-net-backgroundworkerisbusy-always-true.html">2010-08-20 23:52:00</a>
  <i class="icon-pencil"></i> <a class="url fn" href="./author/admin.html">Admin</a>   <i class="icon-folder-open"></i> <a href="./category/technology.html">Technology</a></li> 
  <li><i class="icon-tags"></i> <a href="./tag/net.html">.net</a> <a href="./tag/c.html">C#</a> <a href="./tag/threading.html">Threading</a> </li>
</ul>  </div>
  <div class="page-content"><p>BackgroundWorker provides a great simplified mechanism for seperating
CPU intensive work from the UI thread in C# .NET. Indeed<a href="http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx">the MSDN
documentation does an excellent job detailing its usage</a>. However, you
may come across a bug wherein you need to run the backgroundworker while
it is still running. You have code like this:</p>
<div class="codehilite"><pre><span class="n">System</span><span class="p">.</span><span class="n">ComponentModel</span><span class="p">.</span><span class="n">BackgroundWorker</span> <span class="n">backgroundWorker</span><span class="p">;</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">someEvent</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">backgroundWorker</span><span class="p">.</span><span class="n">IsBusy</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Thread</span><span class="p">.</span><span class="n">Yield</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="n">backgroundWorker</span><span class="p">.</span><span class="n">RunWorkerAsync</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>


<p>But you may find that backgroundWorker.IsBusy is always true so the loop
never executes. It seems that simply yielding the thread will not force
the backgroundWorker to mark itself as done even though that worker
thread has successfully completed. In some situations you are blocking
the UI so it cannot mark itself complete. To resolve the problem, simply
include a call to System.Windows.Forms.Application.DoEvents(). You can
do this even if you are running an application under WPF. It should
force the UI to load a frame.</p>
<div class="codehilite"><pre><span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Forms</span><span class="p">;</span>
<span class="n">System</span><span class="p">.</span><span class="n">ComponentModel</span><span class="p">.</span><span class="n">BackgroundWorker</span> <span class="n">backgroundWorker</span><span class="p">;</span>
<span class="n">public</span> <span class="kt">void</span> <span class="nf">someEvent</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">backgroundWorker</span><span class="p">.</span><span class="n">IsBusy</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Thread</span><span class="p">.</span><span class="n">Yield</span><span class="p">();</span>
        <span class="n">Application</span><span class="p">.</span><span class="n">DoEvents</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="n">backgroundWorker</span><span class="p">.</span><span class="n">RunWorkerAsync</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>


<p>For more information on this method check out <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.application.doevents.aspx">the MSDN documentation on
Application.DoEvents()</a>.</p></div>
  <hr />
  <div>
    <h2>Comments</h2>
    <a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="dandesousa">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
    <div id="disqus_thread"></div>      </div>
</div>	
        </div>
      </div>
    </div>

    <footer class="footer">
    <div class="container">
      <p>Powered by <a href="http://alexis.notmyidea.org/pelican/">Pelican</a></p>
      <p><a href="http://github.com/dandesousa/pelican-timberland">Timberland</a> based on <a href="http://twitter.github.com/bootstrap/">Bootstrap, from Twitter</a>.</p>
      <p><a href="http://glyphicons.com">Glyphicons Free</a> licensed under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p> 
      <p><a href="http://fortawesome.github.com/Font-Awesome">Font Awesome by Dave Gandy</a></p>
      <p>&copy; Dan De Sousa 2013</p>
    </div>
    </footer>
  </body>
</html>